<div class="container mt-4">
  <h1>Scheda</h1>
  <form [formGroup]="form">
  <table class="table table-hover align-middle">
    <thead class="thead-dark">
    <tr class="row-border">
      <th scope="col" class="col-md-1">#</th>
      <th scope="col" class="col-md-3">Esercizio</th>
      <th scope="col" class="col-md-4">Time (s)</th>
      <th scope="col" class="col-md-3">#Serie</th>
      <th scope="col" class="col-md-1">Start</th>
    </tr>
    </thead>
    <tbody formArrayName="tableData">
    <tr class="row-border" *ngFor="let row of tableData.controls; let i = index" [formGroupName]="i" (click)="enableEditing(i)">
      <td scope="row">Esercizio {{i + 1 }}</td>
      <!-- Nome -->
      <td>
        <input maxlength="20" style="width: auto" type="text" formControlName="nomeEsercizio"/>
      </td>
      <!-- Times -->
      <td style="padding: 0;">
        <table class="col-12" style="border-collapse: collapse; border: 0">
          <tr>
            <td>Prepare time:</td>
            <td><input min="0" max="999" type="number" formControlName="prepareTime"/></td>
          </tr>
          <tr>
            <td>Work time:</td>
            <td><input min="0" max="999" type="number" formControlName="workTime"/></td>
          </tr>
          <tr>
            <td>Rest time:</td>
            <td><input min="0" max="999" type="number" formControlName="restAllenamento"/></td>
          </tr>
        </table>
      </td>
      <!-- Serie -->
      <td class="p-0">
        <div class="col-12 h-100 d-flex flex-column justify-content-between">
          <div class="col-12 d-flex justify-content-between align-items-center p-2">
            <div class="col-6">Warm up:</div>
            <div class="col-6"><input min="0" max="999" type="number" formControlName="numSerieRiscaldamento"/></div>
          </div>
          <div class="col-12 d-flex justify-content-between align-items-center p-2">
            <div class="col-6">Work:</div>
            <div class="col-6"><input min="0" max="999"type="number" formControlName="numSerieAllenanti"/></div>
          </div>
        </div>
      </td>
      <!-- Bottoni -->
      <td>
        <button *ngIf="isRowDirty(i) && editingRowIndex === i" type="button" class="btn btn-outline-secondary" (click)="saveEditing(i)">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check-lg" viewBox="0 0 16 16">
            <path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425a.247.247 0 0 1 .02-.022Z"/>
          </svg>
          <span class="visually-hidden">Edit</span>
        </button>
        <button type="button" class="btn btn-outline-secondary" (click)="openTimer(i)">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-play" viewBox="0 0 16 16">
            <path d="M10.804 8 5 4.633v6.734L10.804 8zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692z"/>
          </svg>
          <span class="visually-hidden">Play</span>
        </button>
        <button type="button" class="btn btn-outline-secondary" (click)="deleteRow(i)">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
            <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z"></path>
            <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z"></path>
          </svg>
          <span class="visually-hidden">Delete</span>
        </button>
      </td>
    </tr>
    </tbody>
  </table>
    <div class="container">
      <a class="fixed-add-button">
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-plus-circle" viewBox="0 0 16 16" (click)="addRowToTable()">
          <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
          <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
        </svg>
      </a>
    </div>
  </form>
</div>
